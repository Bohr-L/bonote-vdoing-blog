---
title:  从 MySQL 千万条数据中搜索到指定数据
date: 2025-12-28 21:53:45
permalink: /pages/interview/mysql/
categories:
  - 常见面试题
  - 数据处理与存储类
tags:
  - 
---
核心是 “利用索引 + 优化查询逻辑”，避免全表扫描，具体方案：

- **1. 建立合适的索引**：
    - 若按单字段查询（如`WHERE id=123`），建立主键索引（主键默认自增索引，查询效率 O (log n)）或唯一索引；
    - 若按多字段查询（如`WHERE user_id=1 AND create_time>='2024-01-01'`），建立联合索引（遵循 “最左前缀原则”，将过滤性强的字段放前面）；
    - 避免过度索引（索引会增加写入开销），仅为高频查询字段建索引。
- **2. 优化查询 SQL**：
    - 避免使用`SELECT *`，只查询需要的字段（减少数据传输和内存消耗）；
    - 避免在 WHERE 子句中对字段做函数操作（如`DATE(create_time)='2024-01-01'`会使索引失效），改为`create_time BETWEEN '2024-01-01 00:00:00' AND '2024-01-01 23:59:59'`；
    - 用`LIMIT`限制返回结果（如`LIMIT 1`，找到匹配数据后立即终止查询）。
- **3. 数据库层面优化**：
    - 分库分表：若数据量超千万且单表查询仍慢，按水平分表（如按 user_id 哈希分表）或垂直分表（拆分冷热数据），缩小查询范围；
    - 开启查询缓存（MySQL 8.0 已移除，可通过 Redis 实现应用层缓存）：将高频查询结果缓存，避免重复查库；
    - 优化 MySQL 配置：增大`innodb_buffer_pool_size`（建议设为物理内存的 50%-70%，让更多数据缓存到内存）。