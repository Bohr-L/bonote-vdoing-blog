---
title:  说说 InnoDB 与 MyISAM 的区别
date: 2025-12-29 11:09:15
permalink: /pages/7cb1cd/
categories:
  - 常见面试题
  - MySQL 类
tags:
  - 
---
yISAM 是 MySQL 的两种核心存储引擎，在**事务支持、锁机制、索引结构、数据持久化**等方面差异显著，具体对比如下：

| 对比维度                | InnoDB                                                       | MyISAM                                                       |
| ----------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ |
| **事务支持**            | 支持 ACID 事务（原子性、一致性、隔离性、持久性），支持 COMMIT/ROLLBACK | 不支持事务，操作是原子的（要么全部完成，要么全部失败）       |
| **锁机制**              | 支持行级锁（S 锁 / X 锁）和表级锁，支持间隙锁（避免幻读）    | 仅支持表级锁（读锁 / 写锁），无行级锁                        |
| **索引结构**            | 聚簇索引（主键索引叶子节点存储行数据），非主键索引叶子节点存储主键值 | 非聚簇索引（索引和数据分开存储，索引叶子节点存储数据地址）   |
| **主键要求**            | 必须有主键（无显式主键时，自动生成隐藏 row_id）              | 无主键要求，可无主键或主键重复                               |
| **外键支持**            | 支持外键约束（FOREIGN KEY），确保数据完整性                  | 不支持外键约束                                               |
| **数据持久化**          | 支持崩溃恢复（通过 redo 日志和 undo 日志），数据安全性高     | 不支持崩溃恢复，崩溃后可能丢失数据（仅通过备份恢复）         |
| **表空间存储**          | 支持独立表空间（.ibd 文件，每表一个文件）和系统表空间（ibdata1） | 表数据存储在.frm（表结构）、.MYD（数据文件）、.MYI（索引文件） |
| **全文索引支持**        | JDK 5.6 及之后支持全文索引（FULLTEXT）                       | 早期版本支持全文索引，是其核心优势之一                       |
| **COUNT (\*) 查询性能** | 需遍历表或索引计数（聚簇索引需扫描所有行），性能低           | 存储表的总行数，`COUNT(*)`直接返回结果，性能高               |
| **适用场景**            | 高并发、需事务支持的场景（如电商订单、金融交易）             | 只读或写少读多的场景（如博客、新闻网站）                     |

#### 关键差异详解

- **1. 事务与数据安全性**：
    - InnoDB：通过 redo 日志（记录已提交的修改）和 undo 日志（记录未提交的修改）实现事务和崩溃恢复，即使 MySQL 崩溃，重启后可通过日志恢复数据，确保持久性；
    - MyISAM：无日志机制，崩溃后若数据文件损坏，需通过`myisamchk`工具修复，可能丢失数据，安全性低。
- **2. 锁机制与并发性能**：
    - InnoDB：行级锁支持高并发（如多个事务可同时修改不同行的数据），间隙锁避免幻读；但行级锁实现复杂，开销略高；
    - MyISAM：表级锁在写操作（UPDATE/DELETE/INSERT）时会锁定整个表，其他读 / 写操作需等待，并发性能差（如 100 个写操作需排队执行）。
- **3. 索引与查询性能**：
    - InnoDB：聚簇索引查询主键数据时无需回表，效率高；但非主键查询需先查非主键索引，再查聚簇索引（回表），效率略低；
    - MyISAM：非聚簇索引的叶子节点存储数据地址，查询时直接通过地址读取数据，无需回表；但无聚簇索引，主键查询无优势。
- **4. COUNT (\*) 性能**：
    - MyISAM 在表结构中存储总行数，执行`SELECT COUNT(*) FROM table`时直接返回存储的数值，无需扫描表；
    - InnoDB 无总行数存储，需扫描聚簇索引或非主键索引计数（若非主键索引更小，会选择非主键索引），数据量越大，性能越差。